name: Secret Scanning

on:
  # Run on every pull request
  pull_request:
    branches:
      - main
      - develop

  # Run daily at midnight UTC
  schedule:
    - cron: '0 0 * * *'

  # Allow manual trigger
  workflow_dispatch:

jobs:
  # PR scan - only check changes in the PR
  pr-scan:
    if: github.event_name == 'pull_request'
    uses: venwork-dev/venmode-reusable-workflows/.github/workflows/reusable-gitleaks-workflow.yml@main
    with:
      scan_type: 'pr'
    secrets:
      GH_PAT: ${{ secrets.GH_PAT }}

  # Full repository scan - runs on schedule or manual trigger
  full-scan:
    if: github.event_name == 'schedule' || github.event_name == 'workflow_dispatch'
    uses: venwork-dev/venmode-reusable-workflows/.github/workflows/reusable-gitleaks-workflow.yml@main
    with:
      scan_type: 'full'
    secrets:
      GH_PAT: ${{ secrets.GH_PAT }}
